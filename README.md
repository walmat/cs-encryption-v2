# cs2-encryption
NodeJS Typescript implementation of cybersource v2 encryption

## Installation
```
yarn add cs2-encryption --save

// or

npm i cs2-encryption -S
```


## Card Types Declarations
```
# visa
=> '001'

# mastercard
=> '002'

# american express
=> '003'

# maestro
=> '042'

# discover
=> '004'

# diners club
=> '005'

# jcb
=> '007'

# china unionpay
=> '062'
```

## Usage
```
const context = "eyJraWQiOiJsbiIsImFsZyI6IlJTMjU2In0.eyJmbHgiOnsicGF0aCI6Ii9mbGV4L3YyL3Rva2VucyIsImRhdGEiOiJvNjV0RUdVK216QlB1TFdjdDJUbzRoQUFFUGNMMmN6TmVFc1lkWkJyRUFCWkNkMGRQZ2RRMUlpN0NIRWxtakI1WjdDQVJuZE12L3pZMklpeUErRzYxUk5nbHlsV25EM0E1akJVdVFYM1RFbmV1UmFBT1lqaVVPMkhZRk9aWG5xYkZsNlgiLCJvcmlnaW4iOiJodHRwczovL2ZsZXguY3liZXJzb3VyY2UuY29tIiwiandrIjp7Imt0eSI6IlJTQSIsImUiOiJBUUFCIiwidXNlIjoiZW5jIiwibiI6InY5RWZfSG42TTVhUExIOXcwVFlZTnczVFZhcW1SOWJwLTR2bGdwejdlMUlmeTREZ09VRF9ZVDNXaWVFdmJjdGRQcWdEc201QmwwNHkyZkFwa1JKZEYxWUhBQXdkb3duZ1dRMW1xU3RLTFNObExIU1JBUzN3dTBaNnlBZTNCRUxHNHhueWNIOEdaYmF5bmtpQmtRTElpaDZTRTdMZWhpQ1FjT1gzMldSUGs1OXQzejliVEV6TVBoMlV2WUowYmEyU1pJcW1DRVEtUkN0OEt6TzJEWHhNSVFaSHpIelc2YjlFeE9OLXpBQUF2TjVCeF9SOEhiX0lzV1R4Zi16SUJYMmdhMzI2SEYzMVJjdThfeHpMVW5kcGR6amo0N3Flc1I2cHdsYXpvMkNfMS1fdlNUR3huWnd1OXlBcUZ1VkFwMFdST0dJLWEzejZGem92ZFRPOVBvbXFOdyIsImtpZCI6IjAzd0RWckJyeXdnOEIwSFhmVmx4ZjF2azgzRUhjdEJmIn19LCJjdHgiOlt7ImRhdGEiOnsidGFyZ2V0T3JpZ2lucyI6WyJodHRwczovL3d3dy5wb2tlbW9uY2VudGVyLmNvbSIsImh0dHBzOi8vdGVzdC5wb2tlbW9uY2VudGVyLmNvbSIsImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMCJdLCJtZk9yaWdpbiI6Imh0dHBzOi8vZmxleC5jeWJlcnNvdXJjZS5jb20ifSwidHlwZSI6Im1mLTAuMTEuMCJ9XSwiaXNzIjoiRmxleCBBUEkiLCJleHAiOjE2MDQ2OTI3NTQsImlhdCI6MTYwNDY5MTg1NCwianRpIjoiTUhIc1B2RXNleDhHZWZjRSJ9.C1ED5bRUfstLixKkFatiX0HriBC5YpoAgd8j_02CNpzDap_ED-BTN_yuqCT26FIh8CX9-TqbxPyc2lrkEO5vqpftmN123R0CWvRLPk4ujGr5Mt1iSYl9ZrzBw5aPF7QKeFWmS0zdHqQcX9CKsKxCeYlZi2ObVJmUGMHlQ1ArgbOvYdUJsxhjDT2NG-_VPtrpsSfE48RZRuGGvNr5J1VGqb83t7ftA2Fh1H-gj9gujr_rFwYJy4mGOJSe87YTg1TAHaxQab56OMWkXzWM17V-2oZsA2g-y-btw9t_v6mL9Kj2KTaFK1fsSj5uPV61ISP89pc4nmpOknHgqAxzHriIqA";

const data = {
  number: "4242424242424242",
  securityCode: "123",
  expirationMonth: "10",
  expirationYear: "2021",
  type: "001", // see declarations for card types 
};

const encrypted = await encrypt(data, context);
console.log(encrypted);

// eyJraWQiOiIwM3dEVnJCcnl3ZzhCMEhYZlZseGYxdms4M0VIY3RCZiIsImFsZyI6IlJTQS1PQUVQIiwiZW5jIjoiQTI1NkdDTSJ9.gdvDvlWOm1oYcGcBPCy3PzZUquWE8EM1mcTVlRJnXDCzpVRkXv4rMAlD5v13zpXJvwc6HtBMZbKo18iZJTKm4hRK2wie88S6PjZzOV_LuPxIrMicEvufec9qLVwBULqZax0LxdReWTgfO98Csspueq0lJd_fpm404Df1cjDjjyZnbGoDKcNqfCCj_G_5Wjuzdhs_HVsnau8Lvrxds3ECSs0TM9yOwbeTQZkXcyYA0cfL2yASuGkzFYD_6AB2eATM7ZYur0BHvtxzJgG7skVp2VJCPFGENE38i7CjXSAqKk9blpPHH2MAvn_bnfLqTVq3snPIWyWofZWxIgavnHIyeg.oo5WEFjUprhQes8A.b4wVLwsaa74SRwhh29LnUuQP0cA6VAw_qPJzdexR4PLZoOY4HE3Nv3dHdHN47BlxWcghVAJVSik-KoL1KxULzJMW1E1D_GUUBIptYBL8hY6FQkY-fwJUpkmLoyy7vzFvmQlJ2VBp0EuBZbGXLgJuBA2AbkBnZI8Q4FJ_0ALMlgC2VC2wU1XtM6YUZD5ygFWsqDbMr8JLuPZeTcJXb9RimEc5AoFQ3kh2HP-2TsmDsHEKjV6sSgRCehyeZx-enZP3awEJAnD8k9CQaTkelK1RODdnVQFneRR8Rtd_OBO2lhGkZcACrYzlyFUbewVGqUTkvSZzY4mmMObf1v8IzRIB63ABCDzWKhJBw7sAa3iMIq8u5LvBd-AN2vyZJxC5xS9Kgqf2X0Qi8hM9aGidlDiX5UCZ5VFPF0X1D-3pIrJqpAvxbtLQ1mXqipXVcnL9g5HWAi4qCIjyZb6xr6oVC8hsTi-6EuB0p9lgp7S-ifRAkkQ6ZVsPp-gWqVhvpY6hzoxuBiPyckJGJss3Qn7usGf2VTM0RTMGaUUfp68X1uhxCcUdIGZMW3P_yCx5QIu34xCFZc8zNpvJUVDySmhVjWlgeYoEUG554uUR15Df8-0wgKZr7h7MGgo9npmHzgmHtcgFM1r1nvWHqZ4isTgvsbWqmTbrvbakuiDRUrmYCPgbasFq6F0D3TH8MYcNOteelWEGPrJVVJ8UUidR6qPklxmKFZTYhwDLFIfnOHeljpG4j0vpt2lBo6icm86cXkNO3VGpfIGbROMjxWNX5BNljoIdsZU3cqvTVXp7yvv7O4Tp0hAt6zK8X7b8Qk8YlRdF_v91WF_sIpubXQL9P-USO5Fj_zs2g_ZA51NQWdVsJM7OafKx0ObFAbIKczNpn1buhSscFOpsJiIvtyCNkXnhq9t7hCBlljs2p2gWlW-7NvVEeSbsLSW1X4XF_uhCp_15VmekaMToxLH-BeW2x_MXYO0BV21T_8Z6mjXsr2cy3slDVsmXp4LIf_5ZMReaM1LPfC7Ghd6k1EdTXdDBnBTt2lkoSyWN-AaGFGmbgsf8jfB-QX8JBwzelpq67stA95DFHPVjDfXLI2XwF3E8gsEh1xCm8Jw9ZH_LFtroDzynX3VzNpWFLdBh7a4kQWuWuA1HcyKSoLHQZeA6TkMbKkhbI2txDB92WEBLGHG1qhEke9hsSlDcEwZsnKYC1Vho9aOcKlREQ8zXAJ9B2bRyCUoGd8rTMKC7ea3d_t8euTnOWEyJJ2LDiV8tkw0V69A-I9p0cC3x76QILSIQxN1RrhIpDA36WlVnvOstbv6cMfkagcaMJdY-X4aBQR73Pssjwft7cIGwZNf6C3owuTG4T_Dslez6pOWnSEGUtx6tzfQE2yaiwBZwefSrbw_MZiDPpgFIPXEZQIp9dwiCEBI84kcBLjX_YjOdbDRcqx-UN6Jp15f5S9T4GSy7vOH41_4ssJYdJsY2x_Weson0TY9DGr-VgQO-Do6ILMSyAWUjVJ1dr67TBtzCivonyo-SBDy49jSuIreqNPMckTS2B0qLBRUfaH5RZ4l1GFeWY9g6mw7na9CRDzRl9f5_FQSNTE6PNvu_S2va6ApYPBUWax2swwbUlprL142lNjClhpLJ-sZkQYN0VYVBZ4XePhLFIMjAW4IKB0WONM5-YXZH9O9mjigBRMnPHgfsOKNLg6Gqnk38OkHEIVE_I5JaxBER-lndlg5WXe6GhEBStq6WVexwfUYgo94MKH6nIeTxW_eBpPLwCAVRnlnDJVMj4dWhEdPFXPVLC9GWuXOuKCeN2wgg6qpkgbNOrKxu0C8G4X4XH5TfvWNL1CYmqPJVxauZhTd59ymmDo-apCqFEY6ey2awbQS-nyBYAzDu6xXZNXhRN0ng9ixWQxyvHLJuAJShHjil5M1HSNz85Vv2ErylTz66W_SCcydHCCfJwEFl0E7KMks3ySq9bPgBPcwRxvitpU3Lw6gw3o1PbmFnVN1NsBo-eUWzAnBcclX4OEt_1bQAfmBslQNZRW_3MuaY2NVerL__FUoAvwBKjrQR9l9NVQWkUhCHiOZShzr4gD4ORwO1tPigqFSoJXCyAx4iJk8QeBHY8uW2o3idGrcZ2KeAX3q15e3UJlJ7LmfNy4KHTEx6uJ3msrh_1mgJi2sKzgr81YFEHlG3S28Po7njnNibSnnm7aEtAHSF5LfwouwGvrk9R-37tuXhpgzgGriI9C6TtzG9pgJCt80UuieIXsPc8PyzICymEyNGUs40Iq19cZ3lH5KfbQ0-FE6G3MjJjWyl63xmlS56TfVTmaVytEZ6Hv3x.m83SptGisYtDi1R7VbnT8Q
```